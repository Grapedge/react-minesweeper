(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{123:function(e,t,r){e.exports=r.p+"static/media/996.6ffecb69.png"},124:function(e,t,r){e.exports=r.p+"static/media/flag.14e34939.png"},140:function(e,t,r){e.exports=r(228)},145:function(e,t,r){},146:function(e,t,r){},228:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(3),u=r.n(a),o=(r(145),r(146),r(39)),l=r(40),i=r(23),s="GAME_WIN",f=function(e,t){return{type:"CELL_COVER",row:e,col:t}},m=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],E=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0!==r[e][t].mineCount)return 0;for(var n=r.length,c=r[0]&&r[0].length||0,a=[[e,t]],u={current:0},o=function(){var e=a.shift();m.map((function(t){var o=e[0]+t[0],l=e[1]+t[1];return o>=0&&o<n&&l>=0&&l<c&&!r[o][l].cover&&(r[o][l].cover=!0,u.current=u.current+1,0===r[o][l].mineCount&&a.push([o,l])),t}))};a.length>0;)o();return u.current},O=function(e,t,r){var n=r.length,c=[],a=r[0]&&r[0].length||0,u=!0,o=!1,l=void 0;try{for(var i,s=m[Symbol.iterator]();!(u=(i=s.next()).done);u=!0){var f=i.value,E=e+f[0],O=t+f[1];E>=0&&E<n&&O>=0&&O<a&&(r[E][O].check=!0,c.push([E,O]))}}catch(v){o=!0,l=v}finally{try{u||null==s.return||s.return()}finally{if(o)throw l}}return c},v=function(e,t,r,n,c){if(0===c.length)return 0;var a=0,u=!0,o=!1,l=void 0;try{for(var i,s=c[Symbol.iterator]();!(u=(i=s.next()).done);u=!0){var f=i.value;a=n[f[0]][f[1]].flag?a+1:a,n[f[0]][f[1]].check=!1}}catch(E){o=!0,l=E}finally{try{u||null==s.return||s.return()}finally{if(o)throw l}}var m=0;return e[0]===t&&e[1]===r&&a===n[t][r].mineCount&&c.map((function(e){return n[e[0]][e[1]].flag||n[e[0]][e[1]].cover||(n[e[0]][e[1]].cover=!0,m++),e})),m},C=r(122),p=r.n(C),b=r(17),g={status:"MOUSE_UP",target:null};var j={status:"GAME_IDLE",config:{row:0,col:0,mineCount:0},cells:[[]],checkPos:[],preChecks:[],remainCell:0,normalFlag:0,mineFlag:0},y=function(e,t,r){for(var n=new Array(e).fill(0).map((function(){return new Array(t).fill(0).map((function(){return{type:"CELL_NORMAL",flag:!1,mineCount:0,cover:!1,check:!1}}))})),c=new Array(e*t).fill(0).map((function(e,t){return t})),a=c.length-1;a>0;--a){var u=Math.floor(Math.random()*a),o=[c[u],c[a]];c[a]=o[0],c[u]=o[1]}for(var l=function(r){var a=Math.floor(c[r]/t),u=Math.floor(c[r]%t);n[a][u].type="CELL_MINE",m.map((function(r){return function(r,c){r>=0&&r<e&&c>=0&&c<t&&++n[r][c].mineCount}(a+r[0],u+r[1]),r}))},i=0;i<r;++i)l(i);return{type:"GAME_IDLE",row:e,col:t,cells:n,mineCount:r}},h=function(e){var t=e.status,r=e.normalFlag,n=e.mineFlag,c=e.remainCell,a=e.config.mineCount,u="GAME_OVER"!==t&&(r===n&&n===a||c===a);return u&&console.log("WIN"),u};var w=r(123),d=r.n(w),L=r(124),_=r.n(L),M=["","#3F51B5","#009688","#E91E63","#BA4A00","#F4D03F","#8E44AD","#48C9B0","#CD6155","#558B2F"];function A(e){var t=e.row,r=e.col,a=Object(i.b)(),u=Object(i.c)((function(e){return e.game.cells[t][r]})),o=Object(i.c)((function(e){return e.game.status})),l=Object(i.c)((function(e){return e.mouse})),s=Object(n.useRef)(!1),m=Object(n.useRef)(!1),E=Object(n.useRef)(!1),O=Object(n.useCallback)((function(){"GAME_OVER"!==o&&(E.current?E.current=!1:u.cover||u.flag||("GAME_IDLE"===o&&a({type:"GAME_START"}),a(f(t,r))))}),[u.cover,u.flag,r,a,t,o]),v=Object(n.useCallback)((function(e){"GAME_OVER"!==o&&(s.current=m.current=!1,a(function(e,t){return{type:"CELL_CHECK_END",row:e,col:t}}(t,r)),E.current?E.current=!1:2!==e.button||l.target!==e.target||u.cover||(console.log("\u4f5c\u5f0a\u6a21\u5f0f\uff1a","CELL_MINE"===u.type?"\u5730\u96f7":"\u666e\u901a"),a(function(e,t){return{type:"CELL_FLAG",row:e,col:t}}(t,r))))}),[u.cover,u.type,r,a,l.target,t,o]),C=Object(n.useCallback)((function(e){"GAME_OVER"!==o&&(a({type:"MOUSE_DOWN",payload:e.target}),0===e.button?s.current=!0:2===e.button&&(m.current=!0),u.cover&&s.current&&m.current&&(E.current=!0,a(function(e,t){return{type:"CELL_CHECK",row:e,col:t}}(t,r))))}),[u.cover,r,a,t,o]);Object(n.useEffect)((function(){"GAME_OVER"===o&&"CELL_MINE"===u.type&&a(f(t,r))}),[u,r,a,t,o]),Object(n.useEffect)((function(){u.cover&&"CELL_MINE"===u.type&&a({type:"GAME_OVER"})}),[u.cover,u.type,a]);var b=null;return u.cover?"CELL_MINE"===u.type?b=c.a.createElement("img",{src:d.a,alt:"*",className:"cell-cnt"}):u.mineCount>0?b=c.a.createElement("span",{style:{color:M[u.mineCount]}},u.mineCount):0===u.mineCount&&(b=" "):u.flag&&(b=c.a.createElement("img",{src:_.a,alt:"F",className:"cell-cnt"})),c.a.createElement("div",{className:p()("cell",{"cell-cover":u.cover,"cell-check":u.check}),onClick:O,onMouseDown:C,onMouseUp:v},b)}function k(e){var t=e.row,r=e.col,a=Object(n.useState)([[]]),u=Object(l.a)(a,2),o=u[0],i=u[1];return Object(n.useEffect)((function(){var e=new Array(t).fill(0).map((function(){return new Array(r).fill(0).map((function(e,t){return t}))}));return i(e),function(){i(null)}}),[r,t]),o.map((function(e,n){return c.a.createElement("div",{className:"row",key:n},o[n].map((function(e,a){return n<t&&a<r&&c.a.createElement(A,{key:a,row:n,col:a},"ss")})))}))}var S=r(231),I=r(230),R=r(235),N=r(52),G=r(232),F=r(234),D=r(233),V=0,x={success:"\u606d\u559c\uff0c\u6e38\u620f\u80dc\u5229",error:"\u6e38\u620f\u7ed3\u675f",info:"\u6e38\u620f\u4e2d..."},U=[{dif:"\u521d\u7ea7",row:10,col:10,mineCount:10},{dif:"\u4e2d\u7ea7",row:16,col:16,mineCount:40},{dif:"\u9ad8\u7ea7",row:16,col:30,mineCount:99}];function T(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.game})),r=Object(n.useState)("info"),a=Object(l.a)(r,2),u=a[0],f=a[1],m=Object(n.useState)(0),E=Object(l.a)(m,2),O=E[0],v=E[1],C=Object(n.useState)([]),p=Object(l.a)(C,2),b=p[0],g=p[1],j=Object(n.useState)(!1),h=Object(l.a)(j,2),w=h[0],d=h[1],L=Object(n.useRef)(10),_=Object(n.useRef)(10),M=Object(n.useRef)(!1),A=Object(n.useRef)(10);Object(n.useEffect)((function(){e(y(10,10,10))}),[e]);var T=t.config,P=T.row,B=T.col,W=Object(n.useCallback)((function(e){var t=e.dif,r=e.row,n=e.col,c=e.mineCount;g([{title:"\u96be\u5ea6",content:t},{title:"\u884c\u6570",content:r},{title:"\u5217\u6570",content:n},{title:"\u5730\u96f7",content:c},{title:"\u65f6\u95f4",content:"0S"}])}),[]),H=Object(n.useCallback)((function(e){g((function(t){var r=Object(o.a)(t);return r[4].content=e+"S",r}))}),[]);return Object(n.useEffect)((function(){W({dif:"\u521d\u7ea7",row:10,mineCount:10,col:10})}),[]),Object(n.useEffect)((function(){if(t.status===s){if(!M.current){var e=localStorage.getItem(O);(!e||e&&e>=V)&&localStorage.setItem(O,V)}M.current=!1,f("success")}else"GAME_OVER"===t.status?f("error"):f("info")}),[t.status]),Object(n.useEffect)((function(){var e=null;return"GAME_START"===t.status&&(V=0,e=setInterval((function(){H(++V)}),1e3)),function(){return clearInterval(e)}}),[t.status,H]),c.a.createElement("div",{className:"layout"},c.a.createElement("div",{className:"cntr"},c.a.createElement("div",{className:"game-control"},c.a.createElement(S.a,{header:c.a.createElement("div",null,"\u6e38\u620f\u4fe1\u606f"),bordered:!0,dataSource:b,renderItem:function(e){return c.a.createElement(S.a.Item,null,e.title,"\uff1a",c.a.createElement(I.a.Text,{strong:!0},e.content))}}),c.a.createElement(R.a,{message:x[u],type:u,showIcon:!0}),c.a.createElement(N.a.Group,null,c.a.createElement(N.a,{type:"primary",onClick:function(){return d(!0)}},"\u81ea\u5b9a\u4e49"),c.a.createElement(N.a,{type:"primary",onClick:function(){var e=localStorage.getItem(0),t=localStorage.getItem(1),r=localStorage.getItem(2);window.alert("\u3010\u521d\u7ea7\u3011".concat(e||999,"S\n\u3010\u4e2d\u7ea7\u3011").concat(t||999,"S\n\u3010\u9ad8\u7ea7\u3011").concat(r||999,"S"))}},"\u6392\u884c\u699c"),c.a.createElement(N.a,{type:"primary",onClick:function(){var e=Math.floor((O+1)%U.length);v(e),W(U[e])}},"\u96be\u5ea6"),c.a.createElement(N.a,{type:"primary",onClick:function(){e(y(U[O].row,U[O].col,U[O].mineCount))}},"\u65b0\u6e38\u620f"))),c.a.createElement("div",null,c.a.createElement(k,{row:P,col:B}))),c.a.createElement(G.a,{title:"\u81ea\u5b9a\u4e49\u6e38\u620f",visible:w,onOk:function(){A.current>=L.current*_.current?F.a.error("\u5730\u96f7\u6570\u5e94\u5c0f\u4e8e\u603b\u683c\u6570"):(e(y(L.current,_.current,A.current)),M.current=!0,d(!1))},onCancel:function(){return d(!1)}},c.a.createElement(D.a,{min:1,max:30,placeholder:"\u884c\u6570",defaultValue:10,onChange:function(e){return L.current=e}}),c.a.createElement(D.a,{min:1,max:30,placeholder:"\u5217\u6570",defaultValue:10,onChange:function(e){return _.current=e}}),c.a.createElement(D.a,{min:1,max:900,placeholder:"\u5730\u96f7\u6570",defaultValue:10,onChange:function(e){return A.current=e}})))}r(227);var P=function(){return Object(n.useEffect)((function(){return document.oncontextmenu=function(){return!1},function(){document.oncontextmenu=null}}),[]),c.a.createElement(T,null)},B=r(31),W=Object(B.c)({game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;if(e.status===s&&"GAME_IDLE"!==t.type)return e;var r=[],n={current:!1},c={current:[]},a={current:0},u={current:0},l={current:{}};switch(t.type){case"GAME_IDLE":return Object(b.a)({},e,{status:"GAME_IDLE",config:{row:t.row,col:t.col,mineCount:t.mineCount},cells:t.cells,remainCell:t.row*t.col,mineFlag:0,normalFlag:0,preChecks:[]});case"GAME_OVER":return Object(b.a)({},e,{status:"GAME_OVER"});case"GAME_START":return Object(b.a)({},e,{status:"GAME_START"});case s:return Object(b.a)({},e,{status:s});case"CELL_COVER":return r.current=Object(o.a)(e.cells),r.current[t.row][t.col].cover=!0,a.current="CELL_NORMAL"===r.current[t.row][t.col].type?1:0,"CELL_NORMAL"===r.current[t.row][t.col].type&&(a.current+=E(t.row,t.col,r.current)),u.current=e.remainCell-a.current,l.current=Object(b.a)({},e,{cells:r.current,remainCell:u.current}),n.current=h(l.current),Object(b.a)({},l.current,{status:n.current?s:e.status});case"CELL_FLAG":r.current=Object(o.a)(e.cells),r.current[t.row][t.col].flag=!r.current[t.row][t.col].flag;var i=r.current[t.row][t.col].flag;a.current=e.mineFlag,i&&"CELL_MINE"===r.current[t.row][t.col].type?++a.current:i||"CELL_MINE"!==r.current[t.row][t.col].type||--a.current;var f=a.current,m=e.normalFlag+(r.current[t.row][t.col].flag?1:-1);return l.current=Object(b.a)({},e,{cells:r.current,mineFlag:f,normalFlag:m}),n.current=h(l.current),Object(b.a)({},l.current,{status:n.current?s:e.status});case"CELL_CHECK":r.current=Object(o.a)(e.cells);var C=[t.row,t.col];return c.current=O(C[0],C[1],r.current),Object(b.a)({},e,{cells:r.current,preChecks:c.current,checkPos:C});case"CELL_CHECK_END":return r.current=Object(o.a)(e.cells),a.current=0,a.current=v(e.checkPos,t.row,t.col,r.current,e.preChecks),u.current=e.remainCell-a.current,l.current=Object(b.a)({},e,{checkPos:[],preChecks:[],remainCell:u.current}),n.current=h(l.current),Object(b.a)({},l.current,{status:n.current?s:e.status});default:return e}},mouse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOUSE_DOWN":return Object(b.a)({},e,{type:"MOUSE_DOWN",target:t.payload});case"MOUSE_UP":return Object(b.a)({},e,{type:"MOUSE_UP",target:null});default:return e}}});var H=Object(B.d)(B.a.apply(void 0,[]));var K=Object(B.e)(W,H);u.a.render(c.a.createElement(i.a,{store:K},c.a.createElement(P,null)),document.getElementById("root"))}},[[140,1,2]]]);
//# sourceMappingURL=main.b226ecec.chunk.js.map